version: 3
projects:
- name: atlantis_test
  dir: .
  workflow: custom
  autoplan:
    enabled: true
    when_modified: ["*.tf", "*.tfvars"]

workflows:
  custom:
    plan:
      steps:
      - run: terraform fmt -check
      - run: terraform init
      - run: terraform validate
      - init
      - plan
    apply:
      steps:
      - apply
